<html>
<head>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
  <script src="https://cdn.jsdelivr.net/gh/hiukim/mind-ar-js@1.1.4/dist/mindar-image.prod.js"></script>
  <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>

  <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.1/dist/aframe-extras.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/hiukim/mind-ar-js@1.1.4/dist/mindar-image-aframe.prod.js"></script>

  <!-- Für gifs -->
  <script src="https://rawgit.com/mayognaise/aframe-gif-shader/master/dist/aframe-gif-shader.min.js"></script>
  <script src="https://rawgit.com/mayognaise/aframe-gif-component/master/dist/aframe-gif-component.min.js"></script>

  <!-- Für vids -->

  <script src="https://rawgit.com/mayognaise/aframe-video-shader/master/dist/aframe-vid-shader.min.js"></script>


  <script src="https://cdn.rawgit.com/donmccurdy/aframe-extras/v4.1.2/dist/aframe-extras.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <!-- Quelle: https://jsfiddle.net/Lwtzjnk9/1/ für png sequenzen -->

  <script>
    //Letzter Stand
    // Als



    document.addEventListener("DOMContentLoaded", function() {
      const sceneEl = document.querySelector('a-scene');
      const arSystem = sceneEl.systems["mindar-image-system"];
      const myTarget = document.getElementById("example-target");
      var myBallon = myTarget.children[0];

      const myTarget2 = document.getElementById("example-target2");
      var lovers = myTarget2.children[0];

      const myTarget3 = document.getElementById("example-target3");
      var dancebear = myTarget3.children[0];

      console.log("start");


      myTarget.addEventListener("targetFound", event => {
        console.log("ballon found");

        myTarget.addEventListener("click", e => {

          console.log("lovers clicked");

          myBallon.removeAttribute('material');
          myBallon.setAttribute('material', {
            shader: "gif",
            autoplay: "true",
            src: '#ballon'
          });
          myBallon.play();

        });

      });
      // detect target lost
      myTarget.addEventListener("targetLost", event => {
        console.log("ballon lost");
      });


      myTarget2.addEventListener("targetFound", event => {
        console.log("lovers found");

        myTarget2.addEventListener("click", e => {

          console.log("lovers clicked");

          lovers.setAttribute('material', {
            shader: "gif",
            autoplay: "true"
          });
          lovers.play();

        });
      });
      // detect target lost
      myTarget2.addEventListener("targetLost", event => {
        console.log("lovers lost");
      });

      myTarget3.addEventListener("targetFound", event => {
        console.log("ballon found");

        myTarget3.addEventListener("click", e => {

          console.log("lovers clicked");

          dancebear.removeAttribute('material');
          dancebear.setAttribute('material', {
            shader: "gif",
            autoplay: "true",
            src: '#dancebaer'
          });
          dancebear.play();

        });

      });
      // detect target lost
      myTarget3.addEventListener("targetLost", event => {
        console.log("ballon lost");
      });
    });



    /*
    // clickable
    AFRAME.registerComponent("play-on-click", {

      //Iwie geht bei einem klick alles an?

      init: function() {
        var clicked = new Boolean(false);
        var el = this.el;

        console.log("clicked ist " + clicked);
        console.log("halloooo");

        document.body.addEventListener("click", e => {

          console.log("halloooo 2");


          console.log("clicked ist " + clicked);

          el.setAttribute('material', {
            shader: "gif",
            autoplay: "true"
          });
          clicked = true;
          el.play();

          console.log("clicked ist " + clicked);

        });
        document.body.addEventListener("targetFound", e => {

          console.log("halloooo 3");

          console.log("detected!");
          if(clicked == true) {

            el.play();
          }

        });
        document.body.addEventListener("targetLost", e => {
          console.log("target lost!");
          console.log("halloooo 4");

          el.pause();

        });
      }
    });
  */
  </script>

</head>
<body>



<a-scene mindar-image="imageTargetSrc: ./targets.mind;" vr-mode-ui="enabled: false" device-orientation-permission-ui="enabled: false">
  <a-assets>
    <img id="card" src="8359_BG2.png" />
    <img id="ballon" src="8359.gif" />
    <img id="dancebaer" src="8435.gif" />
    <img id="lovers" src="8406A.gif" />
    <img id="8406A" src="8406A.jpg" />
    <img id="8435" src="8435.jpg" />
    <img id="pusheen" src="pusheen.gif" />


    <a-asset-item id="rechteck" src="./bones_test2.gltf"></a-asset-item>
    <video id="lovers_vid" src="8406A.mp4" crossorigin="anonymous" autoplay loop muted playsinline webkit-playsinline> </video>
  </a-assets>

  <a-camera position="0 0 0" look-controls="enabled: false" cursor="fuse: false; rayOrigin: mouse;" raycaster="far: ${customFields.libVersion}; objects: .clickable"></a-camera>

  <a-entity id="example-target"  mindar-image-target="targetIndex: 0" >
    <!-- <a-gltf-model rotation="0 0 0 " position="0 -0.25 0.3" src="#rechteck" animation-mixer=""> -->
    <a-entity id="myBallon" class="clickable" geometry="primitive:plane;" scale="1 1.5 1" position="0 0 0.1" material="shader:gif;src:#ballon;autoplay:false;" play-on-clickkk ></a-entity>
  </a-entity>

  <a-entity id="example-target2" mindar-image-target="targetIndex: 1">
    <a-entity id="loverss" class="clickable"  geometry="primitive:plane;" scale="1 1.5 1" position="0 0 0.1" material="shader:video;src:#lovers_vid;" ></a-entity>
    <!-- <a-video src="#lovers_vid" scale="1 1.5 1" position="0 0 0.1" play-on-click> </a-video> -->
</a-entity>


  <a-entity  id="example-target3" mindar-image-target="targetIndex: 2">
    <a-entity geometry="primitive:plane;" class="clickable" scale="1 1.5 1" position="0 0 0.1" material="shader:gif;src:#dancebaer;autoplay:false;" ></a-entity>
  </a-entity>
</a-scene>


  <!--TESTTEST-->

</body>
</html>